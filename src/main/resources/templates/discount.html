<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>分析概览</title>

    <link rel="stylesheet" href="/public/frame/static/css/style.css">
    <link rel="icon" href="/public/frame/static/image/code.png">
    <link rel="stylesheet" href="/public/frame/layui/dist/layuiadmin/layui/css/layui.css" media="all">
    <script src="/public/frame/layui/dist/layuiadmin/layui/layui.js" charset="utf-8"></script>
    <link rel="stylesheet" href="/public/frame/layui/dist/layuiadmin/style/admin.css" media="all">
    <link rel="stylesheet" href="/public/frame/layui/css/layui.css" media="all">

</head>

<!--<body class="body" layadmin-themealias="default">-->
<body>


<div class="layui-fluid">
    <div class="layui-form layui-card-header layuiadmin-card-header-auto">
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">分类查询</label>
                <div class="layui-input-block">
                    <select name="discountType" id="discountType">
                        <option value="0">电影</option>
                        <option value="1">生活缴费</option>
                        <option value="2">买单吧商城</option>
                        <option value="3">最红星期五</option>
                        <option value="4">分期还款</option>
                    </select>
                    <div class="layui-unselect layui-form-select">
                        <div class="layui-select-title"><input type="text" placeholder="请选择" value="管理员" readonly=""
                                                               class="layui-input layui-unselect"><i
                                class="layui-edge"></i></div>
                        <dl class="layui-anim layui-anim-upbit" style="">
                            <dd lay-value="0" class="layui-this">管理员</dd>
                            <dd lay-value="1" class="">超级管理员</dd>
                            <dd lay-value="2" class="">纠错员</dd>
                            <dd lay-value="3" class="">采购员</dd>
                            <dd lay-value="4" class="">推销员</dd>
                            <dd lay-value="5" class="">运营人员</dd>
                            <dd lay-value="6" class="">编辑</dd>
                        </dl>
                    </div>
                </div>
            </div>
            <div class="layui-inline">
                <button class="layui-btn layuiadmin-btn-admin" style="background-color: #4E5465" lay-submit=""
                        id="unionSearch" lay-filter="LAY-user-back-search">
                    <i class="layui-icon layui-icon-search layuiadmin-button-btn"></i>
                </button>
            </div>
            <div class="layui-inline">
                <button class="layui-btn layuiadmin-btn-admin" style="background-color: #4E5465" lay-submit=""
                        id="btn-add" lay-filter="LAY-user-back-search">
                    新增
                </button>
            </div>
        </div>
    </div>


    <div class="layui-row layui-col-space15" id="discountIframe" name="discountIframe">
        <!--<div class="layui-col-sm6 layui-col-md3">-->
        <!--<div class="layui-card">-->
        <!--<div class="layui-card-header">-->
        <!--万达电影满100减10优惠券-->
        <!--</div>-->
        <!--<div class="layui-card-body layuiadmin-card-list">-->
        <!--<span> <img src="/public/frame/static/image/wandadianying.png"   alt="logo">-->
        <!--<b>优惠券使用量:200/3000</b></span>-->

        <!--<p>-->
        <!--2019.09.01 20:15:15 <span class="layuiadmin-span-color">至</span>-->
        <!--</p>-->
        <!--<p>2019.09.15 20:15:15</p>-->
        <!--</div>-->

        <!--</div>-->
        <!--</div>-->
        <!--<div class="layui-col-sm6 layui-col-md3">-->
        <!--<div class="layui-card">-->
        <!--<div class="layui-card-header">-->
        <!--万达电影满100减10优惠券-->
        <!--</div>-->
        <!--<div class="layui-card-body layuiadmin-card-list">-->
        <!--<span> <img src="/public/frame/static/image/wandadianying.png"   alt="logo">-->
        <!--<b>优惠券使用量:200/3000</b></span>-->

        <!--<p>-->
        <!--2019.09.01 20:15:15 <span class="layuiadmin-span-color">至</span>-->
        <!--</p>-->
        <!--<p>2019.09.15 20:15:15</p>-->
        <!--</div>-->

        <!--</div>-->
        <!--</div>-->


    </div>
</div>

<!--添加弹出层-->
<div id="set-add-put" style="display:none; width:550px; padding:20px;">
    <form class="layui-form">
        <div class="layui-form-item">
            <label class="layui-form-label">客群选择</label>
            <div class="layui-input-block">
                <select name="discountType" id="add_selectGroup">
                    <option value="">请选择客群种类</option>
                    <option value="0">新获客户</option>
                    <option value="1">高价值客户</option>
                    <option value="2">流失客户</option>
                    <option value="3">连续活跃客户</option>
                    <option value="4">间断活跃客户</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">发放时间</label>
            <div class="layui-input-block">
                <input type="text" id="add_time" name="add_time" placeholder="请选择发放日期" autocomplete="off"
                       class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">发放省份</label>
            <div class="layui-input-block">
                <select name="discountType" id="add_selectShen">
                    <option value="">请选择省份</option>
                    <option value="0">上海市</option>
                    <option value="1">江苏省</option>
                    <option value="2">山东省</option>
                    <option value="3">浙江省</option>
                    <option value="4">安徽省</option>
                </select>
            </div>
            <label class="layui-form-label">发放市区</label>
            <div class="layui-input-block">
                <select name="discountType" id="add_selectShi">
                    <option value="">请选择市区</option>
                    <option value="0">上海市</option>
                </select>
            </div>
            <label class="layui-form-label">发放县/区</label>
            <div class="layui-input-block">
                <select name="discountType" id="add_selectXian">
                    <option value="">请选择市区</option>
                    <option value="0">浦东新区</option>
                    <option value="1">黄浦区</option>
                    <option value="2">徐汇区</option>
                    <option value="3">长宁区</option>
                    <option value="4">静安区</option>
                    <option value="5">虹口区</option>
                    <option value="6">杨浦区</option>
                    <option value="6">嘉定区</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">发放场景</label>
            <div class="layui-input-block">
                <select name="discountType" id="add_selectScene">
                    <option value="">请选择发放场景</option>
                    <option value="0">优惠券兑换</option>
                    <option value="1">AR小游戏</option>
                    <option value="2">小狮子课堂答题</option>
                    <option value="3">签到有礼</option>
                    <option value="4">国庆任务</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">奖励属性</label>
            <div class="layui-input-block">
                <select name="discountType" id="add_selectType">
                    <option value="">请选择奖励属性</option>
                    <option value="0">美食优惠券</option>
                    <option value="1">电影优惠券</option>
                    <option value="2">生活缴费券</option>
                    <option value="3">话费红包</option>
                    <option value="4">商城优惠券</option>
                    <option value="5">短期还款红包</option>
                    <option value="6">分期券</option>
                    <option value="7">商城优惠券</option>
                    <option value="8">远期还款红包</option>
                </select>
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-input-block">
                <button type="button" class="layui-btn layuiadmin-btn-admin" style="background-color: #4E5465" id="add">
                    发布
                </button>
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
            </div>
        </div>
    </form>
</div>
<style id="LAY_layadmin_theme">.layui-side-menu, .layadmin-pagetabs .layui-tab-title li:after, .layadmin-pagetabs .layui-tab-title li.layui-this:after, .layui-layer-admin .layui-layer-title, .layadmin-side-shrink .layui-side-menu .layui-nav > .layui-nav-item > .layui-nav-child {
    background-color: #20222A !important;
}

.layui-nav-tree .layui-this, .layui-nav-tree .layui-this > a, .layui-nav-tree .layui-nav-child dd.layui-this, .layui-nav-tree .layui-nav-child dd.layui-this a {
    background-color: #009688 !important;
}

.layui-layout-admin .layui-logo {
    background-color: #20222A !important;
}</style>
<script type="text/javascript" th:inline="javascript">
    var context = [[${#httpServletRequest.getContextPath()}]];
</script>
<script type="text/javascript" src="/public/frame/layui/layui.js"></script>
<script type="text/javascript" src="/public/js/index.js"></script>
<script type="text/javascript" src="/public/frame/echarts/echarts.min.js"></script>
<script type="text/javascript">
    layui.use(['element', 'form', 'table', 'layer', 'vip_table', 'laydate'], function () {
        var form = layui.form,
            table = layui.table,
            layer = layui.layer,
            vipTable = layui.vip_table,
            element = layui.element,
            $ = layui.jquery;
        var laydate = layui.laydate;

        laydate.render({
            elem: '#add_time' //指定元素
        });

        //进入页面时初始渲染
        $(function () {
            var discountType = $("#discountType").val();
            layer.msg('加载中', {
                icon: 16,
                shade: 0.01,
                time: '9999999'
            });
            var url = context + "Discount/findDiscountByType";
            var data = {
                discountType: discountType //这里将当前的modelId传到后端
            }
            $.post(url, data, function (data) {
                layer.close(layer.index); //关闭正在加载中弹出层
                if (data.code == 1) {//查询成功,替换iframe中的东西
                    layer.msg(data.msg, {
                        icon: 6
                    });

                    var list_html = "";
                    for (var i = 0; i < data.data.length; i++) {
                        list_html += "<div class='layui-col-sm6 layui-col-md3'>" +
                            "<div class='layui-card'>" +
                            "<div class='layui-card-header'>";
                        list_html += data.data[i].discountTitle;
                        list_html += " </div>\n" +
                            "<div class=\"layui-card-body layuiadmin-card-list\">\n" +
                            "<span> <img src='";
                        list_html += data.data[i].discountLogo;
                        list_html += "'><b>优惠券使用量:" + data.data[i].discountLeft + "</b></span>";
                        list_html += "  <p>\n";
                        list_html += data.data[i].discountStartDate + "<span class=\"layuiadmin-span-color\">至</span>\n" +
                            "</p>\n" +
                            "<p>" + data.data[i].discountEndDate + "</p>\n" +
                            "</div>\n" +
                            "\n" +
                            "</div>\n" +
                            "</div>";
                        // list_html += "<li> < a href=''><font size='+2'>";
                        // list_html += "团队口号:" + data.data[0].teamSlogan;
                        // list_html += "</font></ a></li>";
                        // list_html += "<li> < a href=''><font size='+2'>";
                        // list_html += "成立时间:" + data.data[0].teamInitDate;
                        // list_html += "</font></ a></li>";

                    }
                    document.getElementById("discountIframe").innerHTML = list_html;
                } else {
                    layer.msg(data.msg, {
                        icon: 5
                    });
                }
            }, "json");
        });

        //点击新增按钮弹出弹出层
        $('#btn-add').click(function () {
            layer.open({
                type: 1,
                skin: 'layui-layer-rim', //加上边框
                area: ['660px', '450px'], //宽高
                content: $('#set-add-put'),
                title: "奖励信息与规则"
            });
        });
        //对真正的新增事件的监听
        $('#add').click(function () {
            var add_selectGroup = $('input[name="add_selectGroup"]').val(); //获取值
            layer.closeAll();
            layer.msg("发布成功", {
                icon: 6
            });
//             if (add_selectGroup !== '') {
// //打开正在加载中弹出层
//                 layer.msg('加载中', {
//                     icon: 16,
//                     shade: 0.01,
//                     time: '9999999'
//                 });
//                 var url = "survey/add_model";
//                 var data = {
//                     createName: createName,
//                     name: name,
//                     time: time
//                 }
//                 $.post(url, data, function (data) { //使用ajax提交
//                     layer.closeAll();
//                     if (data.code == 1) { //这里的code对应每行弹窗
//                         layer.msg(data.msg, {
//                             icon: 6
//                         });
//                         location.reload();
//                     } else {
//                         layer.msg(data.msg, {
//                             icon: 5
//                         });
//                     }
//                 }, "json");
//             }
        });

        $('#unionSearch').click(function () { //删除全部通过一个获取选中行的值，来删除
            var discountType = $("#discountType").val();
            layer.msg('加载中', {
                icon: 16,
                shade: 0.01,
                time: '9999999'
            });
            var url = context + "Discount/findDiscountByType";
            var data = {
                discountType: discountType //这里将当前的modelId传到后端
            }
            $.post(url, data, function (data) {
                layer.close(layer.index); //关闭正在加载中弹出层
                if (data.code == 1) {//查询成功,替换iframe中的东西
                    layer.msg(data.msg, {
                        icon: 6
                    });
                    var list_html = "";
                    for (var i = 0; i < data.data.length; i++) {
                        list_html += "<div class='layui-col-sm6 layui-col-md3'>" +
                            "<div class='layui-card'>" +
                            "<div class='layui-card-header'>";
                        list_html += data.data[i].discountTitle;
                        list_html += " </div>\n" +
                            "<div class=\"layui-card-body layuiadmin-card-list\">\n" +
                            "<span> <img src='";
                        list_html += data.data[i].discountLogo;
                        list_html += "'><b>优惠券使用量:" + data.data[i].discountLeft + "</b></span>";
                        list_html += "  <p>\n";
                        list_html += data.data[i].discountStartDate + "<span class=\"layuiadmin-span-color\">至</span>\n" +
                            "</p>\n" +
                            "<p>" + data.data[i].discountEndDate + "</p>\n" +
                            "</div>\n" +
                            "\n" +
                            "</div>\n" +
                            "</div>";
                        // list_html += "<li> < a href=''><font size='+2'>";
                        // list_html += "团队口号:" + data.data[0].teamSlogan;
                        // list_html += "</font></ a></li>";
                        // list_html += "<li> < a href=''><font size='+2'>";
                        // list_html += "成立时间:" + data.data[0].teamInitDate;
                        // list_html += "</font></ a></li>";

                    }
                    document.getElementById("discountIframe").innerHTML = list_html;
                } else {
                    layer.msg(data.msg, {
                        icon: 5
                    });
                }
            }, "json");


        });


    });
</script>
</body>

</html>